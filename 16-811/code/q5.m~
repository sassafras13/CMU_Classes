% 16-811 Fall 2019
% Emma Benjaminson
% Assignment 1
% Problem 5

%% 
clc ; clear all ; close all ; 

%% definitions

% matrix A is a 3 x 3 matrix where each row is a point, so each column is
% [x, y, z] coordinates for that point

%% create test points

% let A represent 3 points in 3D space (each row is a point) before
% transformation
A = rand(3,3) ; 

% let's apply a rotation about each axis
theta = pi/6 ; 

Rx = [1, 0, 0 ; 
      0, cos(theta), -sin(theta) ; 
      0, sin(theta), cos(theta) ] ; 
  
Ry = [cos(theta), 0, sin(theta) ; 
      0, 1, 0 ; 
      -sin(theta), 0, cos(theta) ] ; 
  
Rz = [cos(theta), -sin(theta), 0 ; 
      sin(theta), cos(theta), 0 ; 
      0, 0, 1 ] ; 
  
Rtest = Rz*Ry*Rx ; 

% let's produce a random translation
ttest = rand(3,1) ; 

B = Rtest*A + ttest ; 

% let's plot the points before and after
figure(1) 
scatter3(A(:,1),A(:,2),A(:,3)) ; 
labelsA = {'1','2','3'} ; 
text(A(:,1),A(:,2),A(:,3),labelsA) ; 
hold on 
scatter3(B(:,1),B(:,2),B(:,3)) ; 
labelsB = {'1"','2"','3"'} ; 
text(B(:,1),B(:,2),B(:,3),labelsB) ; 
hold off 
legend('A (before transform)','B (after transform)') ; 

%% extract rotation and translation matrices

[R, t] = transformation(A,B) ; 

R 

Rtest

t

ttest

%% transformation

function [R, t] = transformation(A, B) 

    % calculate centroid
    nA = size(A,1)
    Acen = (1/nA) * sum(A,1) % take the average of all the cols for the average centroid
    
    % find the vectors v that are the distance from each point to the
    % centroid
    vA = zeros(nA,nA) ; 
    
    for i = 1:nA
        vA(i,:) = A(i,:) - Acen 
    end
    
    %%%%%
    % B %
    %%%%%
    
    % calculate centroid
    nA = size(A,1)
    Acen = (1/nA) * sum(A,1) % take the average of all the cols for the average centroid
    
    % find the vectors v that are the distance from each point to the
    % centroid
    vA = zeros(nA,nA) ; 
    
    for i = 1:nA
        vA(i,:) = A(i,:) - Acen 
    end 
    
    
end
